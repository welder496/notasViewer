extends layout

block css
   link(rel='stylesheet', href='/stylesheets/tokenfield/css/bootstrap-tokenfield.css')
   link(rel='stylesheet', href='/stylesheets/jquery-ui/jquery-ui.css')
   link(rel='stylesheet', href='/stylesheets/editors5/dist/bootstrap3-wysihtml5.css')
   link(rel='stylesheet', href='/stylesheets/editors5/dist/bootstrap3-wysihtml5-editor.css')
   link(rel='stylesheet', href='/stylesheets/disabled/disabled.css')
   script(src='/stylesheets/datatables/media/js/jquery.js')
   script.
      if (#{show}) {
         $(document).on('ready', function(){
            $('#modalEdit').modal({backdrop: 'static', show: true});
         });
      }

block content
   form.form-horizontal(role="form" method="post" enctype="multipart/form-data")
      div.form-group
         label.control-label.col-sm-2(for="codigo") Código:
         div.col-sm-2
            input#editCodigo.form-control(type="text" placeholder="Insira um número" readonly name="codigo" value="#{codigo}")

      div.form-group
         label.control-label.col-sm-2(for="nota") Nota:
         div.col-sm-10
            textarea#editNota.form-control(disabled rows="20" name="nota" placeholder="Escreva uma nota ou descrição aqui!!") #{nota}

      #listaArquivos.form-group
         label.control-label.col-sm-2(for='arquivos') Arquivo(s) cadastrado(s):
         #itensArquivos.col-sm-10
            if (arquivos != '')
               for arquivo, i in arquivos
                  div(id=i)
                     a(id=i value="#{arquivo}") #{arquivo}

      div.form-group
         label.control-label.col-sm-2(for="tags") Tags:
         div.col-sm-10
            input#editTags.form-control(type="text" name="tags" placeholder="Insira tags aqui!!" value="#{tags}")

      #modalEdit.modal
         .modal-dialog
            .modal-content
               .modal-header
                  button.close(type="button" data-dismiss="modal" aria-hidden="true") &times;
                  h4.modal-title Mensagem:
               .modal-body
                  p #{message}
               .modal-footer
                  button.btn.btn-default(type="button" data-dismiss="modal") Fechar

      div.form-group
         div.col-sm-offset-2.col-sm-2
            button#editEnviar.btn.btn-default Voltar

block script
   script(src='/stylesheets/tokenfield/bootstrap-tokenfield.js')
   script(src='/javascripts/componentsInit/tokenfields.js')
   script(src='/stylesheets/editors5/dist/wysihtml5x-toolbar.min.js')
   script(src='/stylesheets/editors5/dist/bootstrap3-wysihtml5.js')
   script(src='/javascripts/componentsInit/textAreaEditor.js')
   script.
      $(document).on('click','a',function(event){
         var value = $(this).attr('value');
         rest.post('/documents',{codigo: "#{codigo}", value: value},function(data){
               window.location = data;
         });
      });

      $(document).on('click','#editEnviar.btn.btn-default',function(event){
            var last = document.location.href;
            rest.post('/edit',{codigo:'',comando:'post', lastPage: last},function(data){
               document.write(data);
               document.close();
            });
      });

      $(document).on('ready', function(event){
         var count = $('#itensArquivos').children().length;
         if (count == 0)
            $('#listaArquivos').attr('style','display: none');
         else
            $('#listaArquivos').attr('style','display: block');
      });

